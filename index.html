<!DOCTYPE html>
<html>
<head>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Erica+One&family=Nunito+Sans:opsz,wght@6..12,400;6..12,700&display=swap');
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 80vh;
            margin: 0;
            font-family: 'Nunito Sans', sans-serif;
        }
        canvas{
            cursor: ew-resize;
        }
        h1{
            font-size: 40px;
            text-transform: uppercase;
            color: #617F1F;
            font-weight: bold;
            margin: 0;
        }
        #canvas-container {
            background-image: url('assets/ShonkyGameBackgound.png'); /* Replace with the path to your background image */
            background-size: cover;
            position: relative;
            max-width: 100%;
        }
        button{
            padding: 30px 45px;
            font-size: 50px;
            cursor: pointer;
            transition: all 0.15s ease-in-out;
        }
        button:hover{
            background: #000;
        }
        /* Styles for the modal overlay */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1;
        }

        /* Styles for the modal content */
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            border-radius: 5px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            text-align: center;
        }

        /* Close button style */
        .close {
            position: absolute;
            top: 0px;
            right: 10px;
            cursor: pointer;
            font-size: 40px;
            font-weight: bold;
            font-family: 'Erica One', sans-serif;
            color: #0e769f;
        }
        .close:hover{
            color: #333;
        }
    </style>
</head>
<body>
    <!-- Button to open the pop-up -->
<button id="openButton">üçã</button>

<!-- The Modal -->
<div id="myModal" class="modal">
    <div class="modal-content">
        <span class="close" id="closeButton">&times;</span>
        <h1>Shonkys game</h1>
        <img id="lemonImg" src="assets/Lemon.png" style="display: none;">
        <img id="basketImg" src="assets/basket.png" style="display: none;">
        <div id="canvas-container">
            <canvas id="gameCanvas" width="500" height="500"></canvas>
        </div>
    </div>
</div>
    
   

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        // Fruit properties
        const fruitSize = 30;
        const fruits = [];
        let score = 0;
        let lemonsDropped = 0;
        const maxLemons = 30;
        let lemonsToDrop = 2; // Number of lemons to drop each time
        let lemonsDidnotCaught = 0;
        let remainingLemons = maxLemons;

        // Basket properties
        const basketWidth = 60;
        const basketHeight = 40;
        let basketX = (canvas.width - basketWidth) / 2;

        // Event listener for basket movement
        document.addEventListener("keydown", moveBasket);
        document.addEventListener("mousemove", moveBasketWithMouse);
        canvas.addEventListener("mouseover", () => (isMouseOverCanvas = true));
        canvas.addEventListener("mouseout", () => (isMouseOverCanvas = false));

        // Load the lemon image
        const lemonImg = document.getElementById("lemonImg");

        // Load the basket image
        const basketImg = document.getElementById("basketImg");

        // Create random fruits
        function createFruits(count) {
            for (let i = 0; i < count; i++) {
                const fruit = {
                    x: Math.random() * (canvas.width - fruitSize),
                    y: 0,
                    speed: Math.random() * 2 + 2,
                };
                fruits.push(fruit);
            }
        }

        // Move the basket
        function moveBasket(event) {
            if (event.key === "ArrowLeft" && basketX > 0) {
                basketX -= 10;
            } else if (event.key === "ArrowRight" && basketX + basketWidth < canvas.width) {
                basketX += 10;
            }
        }

        // Move basket with Mouse
        function moveBasketWithMouse(event) {
            const mouseX = event.clientX - canvas.getBoundingClientRect().left;
            if (mouseX >= 0 && mouseX <= canvas.width) {
                //basketX = mouseX - basketWidth / 2;
                basketX = Math.min(Math.max(mouseX - basketWidth / 2, 0), canvas.width - basketWidth);
            }
        }

        // Draw the game
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw fruits using the lemon image
            for (let i = 0; i < fruits.length; i++) {
                const fruit = fruits[i];
                ctx.drawImage(lemonImg, fruit.x, fruit.y, fruitSize, fruitSize);
                fruit.y += fruit.speed;

                // Check if the fruit is caught
                if (
                    fruit.y + fruitSize > canvas.height - basketHeight &&
                    fruit.x + fruitSize > basketX &&
                    fruit.x < basketX + basketWidth
                ) {
                    fruits.splice(i, 1);
                    score++;
                    lemonsDropped++;
                    remainingLemons--;
                    createFruits(1); // Drop 2 lemons at a time
                        
                    
                }

                // Remove fruits that go off the screen
                if (fruit.y > canvas.height) {
                    fruits.splice(i, 1);
                    lemonsDropped++;
                    remainingLemons--;
                    createFruits(1);
                }
            }

            // Draw the basket
            ctx.drawImage(basketImg, basketX, canvas.height - basketHeight-27, basketWidth, basketHeight);

            // Display the score
            ctx.fillStyle = "black";
            ctx.font = "20px Arial";
            /*ctx.fillText('üçã' + score + '/' + maxLemons, 10, 30);*/
            ctx.fillText('üçã' + remainingLemons, 440, 30);

            // Check if the game should end
            if (lemonsDropped >= maxLemons) {
                ctx.fillStyle = "red";
                ctx.font = "30px Nunito Sans";
                ctx.fillText("Your score: " + score, canvas.width / 2 - 80, canvas.height / 2);
            } else {
                requestAnimationFrame(draw);
            }
        }
        // Function to reset the game
        function resetGame() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

       /* // Start the game
        createFruits(6); // Initialize with a fruit
        draw();*/



        //MODAL
        // Get references to the modal and buttons
    var modal = document.getElementById('myModal');
    var openBtn = document.getElementById('openButton');
    var closeBtn = document.getElementById('closeButton');

    // Function to open the modal
    openBtn.addEventListener('click', function() {
        modal.style.display = 'block';
        // Start the game
        createFruits(4); // Initialize with a fruit
        draw();
    });

    // Function to close the modal
    closeBtn.addEventListener('click', function() {
        modal.style.display = 'none';
        console.log('resetGame')
        resetGame();
    });

    // Close the modal when clicking outside the content
    window.addEventListener('click', function(event) {
        if (event.target == modal) {
            modal.style.display = 'none';
        }
    });
    </script>
</body>
</html>
